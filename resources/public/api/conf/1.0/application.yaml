openapi: 3.0.3
info:
  title: Trader Goods Profile
  version: '1.0'
  description: |-
    Use the TGP API to submit trader goods-profile records to the Trader Goods
    Profile Service (TGP).

    The [Trader goods profile service
    guide](/guides/trader-goods-profile-service-guide/) contains a detailed
    overview of v1.0 of the API.
  contact: {}
servers:
  - url: https://test-api.service.hmrc.gov.uk
    description: Sandbox
  - url: https://api.service.hmrc.gov.uk
    description: Production
tags:
  - name: Goods records
    description: Information relating to goods records
  - name: Traders profile
    description: Information relating to traders profile
paths:
  /customs/traders/goods-profiles/{eori}/records:
    post:
      tags:
        - Goods records
      summary: Create a goods record for a trader goods-profile
      description: Create a goods record for the good that is being moved.
      operationId: createTraderGoodsProfileRecord
      parameters:
        - $ref: '#/components/parameters/Content-Type'
        - $ref: '#/components/parameters/Accept'
        - $ref: '#/components/parameters/xClientIdParam'
        - $ref: '#/components/parameters/Authorization'
        - $ref: '#/components/parameters/eoriParam'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTGPRecordSchema'
        required: true
      responses:
        '201':
          description: TGP record was successfully created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateTGPRecordResponseSchema'
          headers:
            X-Correlation-ID:
              $ref: '#/components/headers/xCorrelationIdHdr'
        '400':
          description: Bad Request; Incorrect request parameters provided.
        '401':
          description: Unauthorised; Credentials failed
        '403':
          description: Forbidden;   User was valid, but not allowed to perform this action
      security:
        - userRestricted:
            - trader-goods-profiles
  /customs/traders/goods-profiles/{eori}/records/{recordId}:
    patch:
      tags:
        - Goods records
      summary: Update an existing trader goods record
      description: Update an existing TGP record
      operationId: updateTraderGoodsProfileRecord
      parameters:
        - $ref: '#/components/parameters/Content-Type'
        - $ref: '#/components/parameters/Accept'
        - $ref: '#/components/parameters/xClientIdParam'
        - $ref: '#/components/parameters/Authorization'
        - $ref: '#/components/parameters/eoriParam'
        - $ref: '#/components/parameters/recordParam'
      requestBody:
        description: Update an existent TGP record
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateTGPRecordSchema'
        required: true
      responses:
        '200':
          description: OK;   Request completed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateTGPRecordResponseSchema'
          headers:
            X-Correlation-ID:
              $ref: '#/components/headers/xCorrelationIdHdr'
        '400':
          description: Bad Request; Incorrect request parameters provided.
        '401':
          description: Unauthorised; Credentials failed
        '403':
          description: Forbidden;   User was valid, but not allowed to perform this action
        '404':
          description: TGP record not found to update
      security:
        - userRestricted:
            - trader-goods-profiles
components:
  schemas:
    CreateTGPRecordSchema:
      type: object
      required:
        - actorId
        - traderRef
        - comcode
        - goodsDescription
        - countryOfOrigin
        - category
        - comcodeEffectiveFromDate
      properties:
        actorId:
          $ref: '#/components/schemas/actorId'
        traderRef:
          $ref: '#/components/schemas/traderRef'
        comcode:
          $ref: '#/components/schemas/comcode'
        goodsDescription:
          $ref: '#/components/schemas/goodsDescription'
        countryOfOrigin:
          $ref: '#/components/schemas/countryOfOrigin'
        category:
          $ref: '#/components/schemas/category'
        assessments:
          $ref: '#/components/schemas/assessments'
        supplementaryUnit:
          $ref: '#/components/schemas/supplementaryUnit'
        measurementUnit:
          $ref: '#/components/schemas/measurementUnit'
        comcodeEffectiveFromDate:
          $ref: '#/components/schemas/comcodeEffectiveFromDate'
        comcodeEffectiveToDate:
          $ref: '#/components/schemas/comcodeEffectiveToDate'
    UpdateTGPRecordSchema:
      type: object
      required:
        - eori
        - actorId
        - recordId
        - comcode
        - goodsDescription
        - countryOfOrigin
        - category
        - comcodeEffectiveFromDate
      properties:
        eori:
          $ref: '#/components/schemas/eori'
        actorId:
          $ref: '#/components/schemas/actorId'
        recordId:
          $ref: '#/components/schemas/recordId'
        traderRef:
          $ref: '#/components/schemas/traderRef'
        comcode:
          $ref: '#/components/schemas/comcode'
        goodsDescription:
          $ref: '#/components/schemas/goodsDescription'
        countryOfOrigin:
          $ref: '#/components/schemas/countryOfOrigin'
        category:
          $ref: '#/components/schemas/category'
        assessments:
          $ref: '#/components/schemas/assessments'
        supplementaryUnit:
          $ref: '#/components/schemas/supplementaryUnit'
        measurementUnit:
          $ref: '#/components/schemas/measurementUnit'
        comcodeEffectiveFromDate:
          $ref: '#/components/schemas/comcodeEffectiveFromDate'
        comcodeEffectiveToDate:
          $ref: '#/components/schemas/comcodeEffectiveToDate'
    CreateTGPRecordResponseSchema:
      required:
        - recordId
        - eori
        - actorId
        - traderRef
        - comcode
        - accreditationStatus
        - goodsDescription
        - countryOfOrigin
        - category
        - comcodeEffectiveFromDate
        - version
        - active
        - toReview
        - declarable
        - ukimsNumber
        - createdDateTime
        - updatedDateTime
      type: object
      properties:
        recordId:
          $ref: '#/components/schemas/recordId'
        eori:
          $ref: '#/components/schemas/eori'
        actorId:
          $ref: '#/components/schemas/actorId'
        traderRef:
          $ref: '#/components/schemas/traderRef'
        comcode:
          $ref: '#/components/schemas/comcode'
        accreditationStatus:
          $ref: '#/components/schemas/accreditationStatus'
        goodsDescription:
          $ref: '#/components/schemas/goodsDescription'
        countryOfOrigin:
          $ref: '#/components/schemas/countryOfOrigin'
        category:
          $ref: '#/components/schemas/category'
        assessments:
          $ref: '#/components/schemas/assessments'
        supplementaryUnit:
          $ref: '#/components/schemas/supplementaryUnit'
        measurementUnit:
          $ref: '#/components/schemas/measurementUnit'
        comcodeEffectiveFromDate:
          $ref: '#/components/schemas/comcodeEffectiveFromDate'
        comcodeEffectiveToDate:
          $ref: '#/components/schemas/comcodeEffectiveToDate'
        version:
          $ref: '#/components/schemas/version'
        active:
          $ref: '#/components/schemas/active'
        toReview:
          $ref: '#/components/schemas/toReview'
        reviewReason:
          $ref: '#/components/schemas/reviewReason'
        declarable:
          $ref: '#/components/schemas/declarable'
        ukimsNumber:
          $ref: '#/components/schemas/ukimsNumber'
        nirmsNumber:
          $ref: '#/components/schemas/nirmsNumber'
        niphlNumber:
          $ref: '#/components/schemas/niphlNumber'
        createdDateTime:
          $ref: '#/components/schemas/createdDateTime'
        updatedDateTime:
          $ref: '#/components/schemas/updatedDateTime'
    UpdateTGPRecordResponseSchema:
      required:
        - eori
        - actorId
        - recordId
        - comcode
        - goodsDescription
        - countryOfOrigin
        - category
        - supplementaryUnit
        - measurementUnit
        - comcodeEffectiveFromDate
        - version
        - state
        - declarable
        - ukimsNumber
        - nirmsNumber
        - niphlNumber
        - createdDateTime
        - updatedDateTime
      type: object
      properties:
        eori:
          $ref: '#/components/schemas/eori'
        actorId:
          $ref: '#/components/schemas/actorId'
        recordId:
          $ref: '#/components/schemas/recordId'
        traderRef:
          $ref: '#/components/schemas/traderRef'
        comcode:
          $ref: '#/components/schemas/comcode'
        accreditationStatus:
          $ref: '#/components/schemas/accreditationStatus'
        accreditationWithdrawalReason:
          type: string
          description: >-
            To be provided when accreditationStatus has been set to "Withdrawn" from
            "Withdraw Accreditation" which withdraws the accreditation request.
          example: Advice received by webchat, no longer needed
        goodsDescription:
          $ref: '#/components/schemas/goodsDescription'
        countryOfOrigin:
          $ref: '#/components/schemas/countryOfOrigin'
        category:
          $ref: '#/components/schemas/category'
        assessments:
          $ref: '#/components/schemas/assessments'
        supplementaryUnit:
          $ref: '#/components/schemas/supplementaryUnit'
        measurementUnit:
          $ref: '#/components/schemas/measurementUnit'
        comcodeEffectiveFromDate:
          $ref: '#/components/schemas/comcodeEffectiveFromDate'
        comcodeEffectiveToDate:
          $ref: '#/components/schemas/comcodeEffectiveToDate'
        version:
          $ref: '#/components/schemas/version'
        active:
          $ref: '#/components/schemas/active'
        declarable:
          $ref: '#/components/schemas/declarable'
        toReview:
          $ref: '#/components/schemas/toReview'
        reviewReason:
          $ref: '#/components/schemas/reviewReason'
        ukimsNumber:
          $ref: '#/components/schemas/ukimsNumber'
        nirmsNumber:
          $ref: '#/components/schemas/nirmsNumber'
        niphlNumber:
          $ref: '#/components/schemas/niphlNumber'
        createdDateTime:
          $ref: '#/components/schemas/createdDateTime'
        updatedDateTime:
          $ref: '#/components/schemas/updatedDateTime'
    recordId:
      type: string
      format: uuid
      example: 8ebb6b04-6ab0-4fe2-ad62-e6389a8a204f
      description: ID of the record for the TGP Product in the TGP Core database (UUID)
    eori:
      type: string
      minLength: 14
      maxLength: 17
      example: GB123456789012
      description: >-
        Identity of the trader as known to HMRC. In the UK this is the 14-17
        character EORI number.
    actorId:
      type: string
      minLength: 14
      maxLength: 17
      example: GB987654321098
      description: >-
        EORI number of the user making the change, which may be different to the
        trader.
    traderRef:
      type: string
      minLength: 1
      maxLength: 512
      example: SKU123456
      description: >-
        Unique product reference used by the trader to identify the goods. For
        example a Stock Keeping Unit (SKU) code.
    comcode:
      type: string
      minLength: 6
      maxLength: 10
      example: 123456
      description: A code specific to goods that is internationally recognised.
    accreditationStatus:
      type: string
      minLength: 1
      maxLength: 35
      description: >-
        Indicates the accreditation status of a record if the trader has
        requested that HMRC review their commodity code.
      example: Not Requested
      enum:
        - Not Requested
        - Requested
        - In progress
        - Information Requested
        - Withdrawn
        - Approved
        - Rejected
    goodsDescription:
      type: string
      minLength: 1
      maxLength: 512
      example: Bananas
      description: >-
        Description of the goods using terminology that is familiar to the
        trader. For example, Bananas or T-Shirts.
    countryOfOrigin:
      type: string
      minLength: 2
      maxLength: 2
      example: GB
      description: >-
        Country where the product came from. This is a char field with 2 letters
        in it as per ISO 3166 standards.
    category:
      type: integer
      minimum: 1
      maximum: 3
      example: 2
      description: >-
        The category of the goods based on applicable restrictions,
        prohibitions, or any exemptions the trader may hold.


        Valid values 1,2,3
    assessments:
      description: >-
        Array of category assessment data describing the measures which apply to
        the trader's movement of goods, and how the trader is exempt (if
        applicable).
      type: array
      items:
        $ref: '#/components/schemas/Assessment'
    supplementaryUnit:
      type: number
      example: 13
      description: >-
        Supplementary units are sometimes needed on H8 declarations and provide
        a quantity of goods in a specified unit of measurement. For example,
        13.
    measurementUnit:
      type: string
      minLength: 1
      maxLength: 255
      example: Kilograms
      description: >-
        Measurement units define the required unit of measure when a
        supplementary unit is needed on an H8 declaration. Measurement units are defined in the 
        [Trade Tariff commodities API](https://api.trade-tariff.service.gov.uk/reference-data.html#measurement-units)
    comcodeEffectiveFromDate:
      type: string
      format: date-time
      pattern: ^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$
      example: 2023-01-01T00:00:00Z
      description: >-
        Date in the (OTT) when authorised usage of a commodity code came into
        effect.
    comcodeEffectiveToDate:
      type: string
      format: date-time
      pattern: ^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$
      example: 2028-01-01T00:00:00Z
      description: >-
        Date in the (OTT) when authorised usage of a commodity code expired or
        will expire.
    version:
      type: integer
      format: int64
      description: Version of the TGP Product
      example: 1
    active:
      type: boolean
      example: true
      description: Status of the TGP Product
    toReview:
      type: boolean
      example: false
      description: Notification of whether the trader needs to review the record
    reviewReason:
      type: string
      minLength: 1
      maxLength: 512
      example: Commodity code changed
      description: Reason for toReview being true
    declarable:
      type: string
      minLength: 1
      maxLength: 100
      example: IMMI declarable
      description: Status of TGP Product record for H8 declarations.
    ukimsNumber:
      type: string
      minLength: 32
      maxLength: 32
      example: XIUKIM47699357400020231115081800
      description: UK Internal Market Scheme registration number
    nirmsNumber:
      type: string
      minLength: 13
      maxLength: 13
      example: RMS-GB-123456
      description: Northern Ireland Retail Movement Scheme registration number
    niphlNumber:
      type: string
      minLength: 8
      maxLength: 8
      example: 6 S12345
      description: Northern Ireland Plant Health Label scheme registration number
    createdDateTime:
      type: string
      format: date-time
      pattern: ^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$
      example: 2023-01-01T00:00:00Z
      description: Timestamp when the record was  created in B&T TGP Core database
    updatedDateTime:
      type: string
      format: date-time
      pattern: ^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$
      example: 2023-01-01T00:00:00Z
      description: Timestamp when the record was  last updated in B&T TGP Core database
    Assessment:
      type: object
      properties:
        assessmentId:
          type: string
          minLength: 1
          maxLength: 35
          example: a06846e9a5f61fa4ecf2c4e3b23631fc
          description: >-
            The ID of the category assessment(s) retrieved from the 
            [Trade Tariff Green Lanes API](https://api.trade-tariff.service.gov.uk/green-lanes.html#get-green-lanes-category-assessments)
        primaryCategory:
          type: integer
          example: 1
          description: The primary category of the assessment
        condition:
          $ref: '#/components/schemas/Condition'
    Condition:
      description: >-
        A collection of data detailing the condition the trader meets to exempt
        the category assessment
      type: object
      properties:
        type:
          type: string
          minLength: 1
          maxLength: 35
          example: certificate
          description: >-
            The type of condition/exemption as provided by the 
            [Trade Tariff Green Lanes API](https://api.trade-tariff.service.gov.uk/green-lanes.html#get-green-lanes-category-assessments)
        conditionId:
          type: string
          minLength: 1
          maxLength: 10
          example: Y923
          description: >-
            The ID/code of the condition as provided by the 
            [Trade Tariff Green Lanes API](https://api.trade-tariff.service.gov.uk/green-lanes.html#get-green-lanes-category-assessments)
        conditionDescription:
          type: string
          minLength: 1
          maxLength: 512
          example: >-
            Products not considered as waste according to Regulation (EC) No
            1013/2006 as retained in UK law
          description: >-
            The description of the condition as provided by the 
            [Trade Tariff Green Lanes API](https://api.trade-tariff.service.gov.uk/green-lanes.html#get-green-lanes-category-assessments)
        conditionTraderText:
          type: string
          minLength: 1
          maxLength: 512
          example: Excluded product
          description: >-
            A free text statement provided by the trader if required in the CDS
            guidance
  parameters:
    Content-Type:
      name: Content-Type
      in: header
      description: Specifies the format of the request body, which must be JSON.
      required: true
      schema:
        type: string
        example: application/json
    Accept:
      name: Accept
      in: header
      description: Specifies the response format and the [version](/api-documentation/docs/reference-guide#versioning) of the API to be used.
      schema:
        type: string
        example: application/vnd.hmrc.1.0+json
      required: true
    Authorization:
      name: Authorization
      in: header
      description: An OAuth 2.0 Bearer Token.
      schema:
        type: string
        example: Bearer 59fc92c1cdf0b8ef1f138a702effdbd2
      required: true
    xClientIdParam:
      in: header
      name: X-Client-ID
      required: true
      schema:
        type: string
        example: TSS
      description: Identifier of calling system
    eoriParam:
      in: path
      name: eori
      required: true
      schema:
        $ref: '#/components/schemas/eori'
      description: >-
        Identity of the trader as known to HMRC. In the UK this is the 14-17
        character EORI number.
    recordParam:
      in: path
      name: recordId
      required: true
      schema:
        $ref: '#/components/schemas/recordId'
      description: >-
        ID of the record for the TGP Product in the TGP Core database (UUID)
  headers:
    xCorrelationIdHdr:
      description: A unique id created at source, i.e. client to TGP Digital.
      required: true
      schema:
        type: string
        format: uuid
        example: 8ebb6b04-6ab0-4fe2-ad62-e6389a8a204f
  securitySchemes:
    userRestricted:
      type: oauth2
      description: >-
        HMRC supports OAuth 2.0 for authenticating user restricted API requests
        using an OAuth 2.0 Bearer Token in the AUTHORIZATION header. See
        https://developer.service.hmrc.gov.uk/api-documentation/docs/authorisation/user-restricted-endpoints
        for details.
      flows:
        authorizationCode:
          authorizationUrl: https://api.service.hmrc.gov.uk/oauth/authorize
          tokenUrl: https://api.service.hmrc.gov.uk/oauth/token
          refreshUrl: https://api.service.hmrc.gov.uk/oauth/refresh
          scopes:
            trader-goods-profiles: Access all aspects of TGP API
    applicationRestricted:
      type: oauth2
      description: >-
        HMRC supports OAuth 2.0 for authenticating application restricted API 
        requests using an OAuth 2.0 Bearer Token in the AUTHORIZATION header.
        See
        https://developer.service.hmrc.gov.uk/api-documentation/docs/authorisation/application-restricted-endpoints
        for details.
      flows:
        clientCredentials:
          tokenUrl: https://api.service.hmrc.gov.uk/oauth/token
          scopes:
            trader-goods-profiles: Access traders' goods profile and record via the TGP API
